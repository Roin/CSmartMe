<html>
<head>
<script type="text/javascript"
 src="http://code.jquery.com/jquery-1.9.1.js">
</script>
<script src="http://code.highcharts.com/highcharts.js"></script>
</head>
<body>
   <!--<canvas id="myCanvas" width="600" height="400"
     style="border:1px solid #000000;">
   </canvas> -->
   <div id="container" style="height: 400px"></div>
   <p id="testing"></p>
   <button onClick="stopFunction()">Stop the execution</button>
   
 <!--<script type="text/javascript">
 var request
 function Test() {
   var data = "Test";
   if(request) {
    request.abort();
   }
   var request = $.ajax( {
     type: "GET",
     url: "stuff/",
     data: data
   });
   request.done(function (response, textStatus, jqXHR){
      var c=document.getElementById("myCanvas");
      var ctx=c.getContext("2d");
      //ctx.clearRect(0, 0, c.width, c.height);
      var img= new Image();
      img.src = response["Path"];
      ctx.drawImage(img, 0, 0);
     
        // log a message to the console
      console.log(response["Path"]);
    });
   request.fail(function (jqXHR, textStatus, errorThrown){
        // log the error to the console
        console.error(
            "The following error occured: "+
            textStatus, errorThrown
        );
    });
     request.always(function () {
        // reenable the inputs
        console.log("stub stub stub");
    });
  }-->
<script type="text/javascript">
  var request
  function Test(){
     var data = "Test";
     if(request) {
       request.abort();
     }
     var request = $.ajax( {
       type: "GET",
       url: "stuff/",
       data: data
     });
     request.done(function(response, textStatus, jqXHR) {
       var chart1 = new Highcharts.Chart({
          chart: {
              renderTo: 'container',
              type: 'line'
          },
          title: {
              text: 'Smart Meter Data'
          },
          xAxis: {
              categories: response["PubDate"]
          },
          yAxis: {
              title: {
                  text: 'Values'
              }
          },
          series: [{
              name: 'L1',
              data: response["L1"]
          }, {
              name: 'L2',
              data: response["L2"]
          }, {
	      name: 'L3',
	      data: response["L3"]
	      }]
      });
  });
  request.fail(function (jqXHR, textStatus, errorThrown){
        // log the error to the console
        console.error(
            "The following error occured: "+
            textStatus, errorThrown
        );
    });
     request.always(function () {
        // reenable the inputs
        console.log("stub stub stub");
    }); 
}

  function stopFunction()
  {
    clearInterval(myVar);
    console.log("Stoped the stuff");
    document.getElementById("testing").innerHTML="Stoped";
  }
 var myVar = setInterval("Test()", 5000);
 
</script>

</body>
</html>
